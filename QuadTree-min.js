(function(h){var g=5,i=4,d=[],b="object",c=null,f=Math.ceil;function a(){this.root=new e(0,0,Crafty.window.width,Crafty.window.height,0)}a.prototype={get:function(j,n,l,m){if(typeof j===b){n=j.y;l=j.w;m=j.h;j=j.x}d=[];var k=this.root.get(j,n,l,m);return k||d},put:function(j,m,l){var k;if(typeof l!==b){l={x:j,y:m,w:1,h:1,obj:l}}if(typeof j===b){l=j;m=j.y;j=j.x}k=this.root.f(j,m,1,1);if(k){k.obj.push(l);if(k.obj.length>i&&k.lvl<g){k.divide()}}},destroy:function(){this.root.destroy()}};function e(j,n,k,m,l){this.x=j;this.y=n;this.w=k;this.h=m;this.lvl=l;this.obj=[];this.nw=c;this.ne=c;this.sw=c;this.se=c}e.prototype={divide:function(){if(this.nw&&this.ne&&this.sw&&this.se){return}var j=f(this.w/2),o=f(this.h/2),n=0,k=this.obj.length,m,p;this.nw=new e(0,0,j,o,this.lvl+1);this.ne=new e(j,0,j+j,o,this.lvl+1);this.sw=new e(0,o,j,o+o,this.lvl+1);this.se=new e(j,o,j+j,o+o,this.lvl+1);for(;n<k;n++){m=this.obj[n];p=this.f(m.x,m.y,1,1);p.obj.push(m);if(p.obj.length>i&&this.lvl<g){p.divide()}}this.obj.length=0;this.obj=c},get:function(k,q,m,n){if(this.x<k+m&&this.x+this.w>k&&this.y<q+n&&this.h+this.y>q){if(this.nw&&this.ne&&this.sw&&this.se){var l=this.nw.get(k,q,m,n),p=this.ne.get(k,q,m,n),j=this.sw.get(k,q,m,n),o=this.se.get(k,q,m,n);if(l){d=d.concat(l)}if(p){d=d.concat(p)}if(j){d=d.concat(j)}if(o){d=d.concat(o)}}else{return this.obj}}else{return false}},f:function(j,m,k,l){if(this.x<j+k&&this.x+this.w>j&&this.y<m+l&&this.h+this.y>m){if(this.nw&&this.ne&&this.sw&&this.se){return this.nw.f(j,m,k,l)||this.ne.f(j,m,k,l)||this.sw.f(j,m,k,l)||this.se.f(j,m,k,l)}else{return this}}else{return false}},destroy:function(){if(this.nw&&this.ne&&this.sw&&this.se){this.nw.destroy();this.ne.destroy();this.sw.destroy();this.se.destroy()}this.obj.length=0;this.nw=c;this.ne=c;this.sw=c;this.se=c}};h.QTree=a})(Crafty);