(function(e){var h=6,f=6,c=[],b="object",g=Math.ceil;function d(){this.root=new a(0,0,Crafty.window.width,Crafty.window.height,null,0)}d.prototype={find:function(i,m,k,l){if(typeof i===b){m=i.y;k=i.w;l=i.h;i=i.x}c=[];var j=this.root.find(i,m,k,l);return j||c},put:function(i,o,j,k,n){var m;if(typeof i===b){n=i;k=i.h;j=i.w;o=i.y;i=i.x}m=this.root.get(i,o,j,k);if(m){var l=new a(i,o,j,k,m,m.lvl+1);l.obj=n;m.children.push(l);m.update(i,o,j,k);if(m.children.length>=f&&m.lvl<h){m.divide()}}}};function a(i,n,j,m,l,k){this.x=i;this.y=n;this.w=j;this.h=m;this.parent=l;this.lvl=k;this.children=[];this.obj=null}a.prototype={divide:function(){var o=0,n=this.children.length,u=g(n/2),m,s,q=new a(0,0,0,0,this,this.lvl+1),p=new a(0,0,0,0,this,this.lvl+1),t,r,k=[[],[]],j=[{},{}];if(!n){return}for(;o<n;o++){m=this.children[o];s=+(o>=u);k[s].push(m);m.parent=s?p:q;if(m.x<j[s].x||!("x" in j[s])){j[s].x=m.x}if(m.y<j[s].y||!("y" in j[s])){j[s].y=m.y}if(m.x+m.w>j[s].x+j[s].w||!("w" in j[s])){j[s].w=m.w+m.x}if(m.y+m.h>j[s].y+j[s].h||!("h" in j[s])){j[s].h=m.h+m.y}}j[0].w-=j[0].x;j[1].w-=j[1].x;j[0].h-=j[0].y;j[1].h-=j[1].y;t=j[0];r=j[1];q.x=t.x;q.y=t.y;q.w=t.w;q.h=t.h;p.x=r.x;p.y=r.y;p.w=r.w;p.h=r.h;q.children=k[0];p.children=k[1];this.children=[q,p]},update:function(i,l,j,k){if(this.x>i){this.x=i}if(this.y>l){this.y=l}if(this.x+this.w<i+j){this.w=i+j-this.x}if(this.y+this.h<l+k){this.h=l+k-this.y}if(this.parent!==null){this.parent.update(i,l,j,k)}},get:function(j,q,m,o){var n=0,k=this.children.length,p;if(this.x<j+m&&this.x+this.w>j&&this.y<q+o&&this.h+this.y>q){if(!k){return this.parent||this}for(;n<k;n++){p=this.children[n].get(j,q,m,o);if(p){return p}}return this}else{return false}},find:function(j,q,m,o){var n=0,k=this.children.length,p;if(this.x<j+m&&this.x+this.w>j&&this.y<q+o&&this.h+this.y>q){if(!k){return this.obj}for(;n<k;n++){p=this.children[n].find(j,q,m,o);if(p){c=c.concat(p)}}}else{return false}}};e.RTree=d})(Crafty);