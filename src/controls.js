Crafty.c("mouse", {	init: function() {		function dispatch(e) {			var flag = false;						if(this.area && this.area.containsPoint(e.pageX, e.pageY)) flag = true;			else if(this.isAt(e.pageX, e.pageY) || this.has("DOM")) flag = true;							if(flag) this.trigger(e.type, e);		}				//setup DOM clicks		if(this.has("DOM")) {			Crafty.addEvent(this, this._element, "click", dispatch);			Crafty.addEvent(this, this._element, "mousedown", dispatch);			Crafty.addEvent(this, this._element, "mouseup", dispatch);						this.bind("remove", function() {				Crafty.removeEvent(this, this._element, "click", dispatch);				Crafty.removeEvent(this, this._element, "mousedown", dispatch);				Crafty.removeEvent(this, this._element, "mouseup", dispatch);			});		}	},		//TODO: move with obj	areaMap: function(poly) {		//create polygon		if(arguments.length > 1) {			//convert args to array to create polygon			var args = Array.prototype.slice.call(arguments, 0),				i = 0, l = args.length;						for(;i<l;i++) {				args[i][0] += this.x;				args[i][1] += this.y;			}						poly = new Crafty.polygon(args);		}				this.map = poly;		this.attatch(this.map);		return this;	}});Crafty.c("controls", {	__move: {left: false, right: false, up: false, down: false},		_speed: 3,		init: function() {		function dispatch(e) {			e.keyCode = e.charCode || e.keyCode;			this.trigger(e.type, e);		}				Crafty.addEvent(this, "keydown", dispatch);		Crafty.addEvent(this, "keyup", dispatch);				//remove events		this.bind("remove", function() {			Crafty.removeEvent(this, "keydown", dispatch);			Crafty.removeEvent(this, "keyup", dispatch);		});		return this;	}});Crafty.c("fourway", {			fourway: function(speed) {		if(speed) this._speed = speed;		var move = this.__move;				this.bind("enterframe", function() {			var old = this.pos(),				changed = false;			if(move.right) {				this.x += this._speed;				changed = true;			}			if(move.left) {				this.x -= this._speed;				changed = true;			}			if(move.up) {				this.y -= this._speed;				changed = true;			}			if(move.down) {				this.y += this._speed;				changed = true;			}						if(changed) this.trigger("change", old);		}).bind("keydown", function(e) {			if(e.keyCode === Crafty.keys.RA || e.keyCode === Crafty.keys.D) {				move.right = true;			}			if(e.keyCode === Crafty.keys.LA || e.keyCode === Crafty.keys.A) {				move.left = true;			}			if(e.keyCode === Crafty.keys.UA || e.keyCode === Crafty.keys.W) {				move.up = true;			}			if(e.keyCode === Crafty.keys.DA || e.keyCode === Crafty.keys.S) {				move.down = true;			}		}).bind("keyup", function(e) {			if(e.keyCode === Crafty.keys.RA || e.keyCode === Crafty.keys.D) {				move.right = false;			}			if(e.keyCode === Crafty.keys.LA || e.keyCode === Crafty.keys.A) {				move.left = false;			}			if(e.keyCode === Crafty.keys.UA || e.keyCode === Crafty.keys.W) {				move.up = false;			}			if(e.keyCode === Crafty.keys.DA || e.keyCode === Crafty.keys.S) {				move.down = false;			}		});				return this;	}});Crafty.c("twoway", {	__move: {left: false, right: false, up: false, falling: false},		twoway: function(speed,jump) {		if(speed) this._speed = speed;		jump = jump || this._speed * 2;				var move = this.__move;				this.bind("enterframe", function() {			var old = this.pos(),				changed = false;			if(move.right) {				this.x += this._speed;				changed = true;			}			if(move.left) {				this.x -= this._speed;				changed = true;			}			if(move.up) {				this.y -= jump;				this._falling = true;				changed = true;			}						if(changed) this.trigger("change", old);		}).bind("keydown", function(e) {			if(e.keyCode === Crafty.keys.RA || e.keyCode === Crafty.keys.D) {				move.right = true;			}			if(e.keyCode === Crafty.keys.LA || e.keyCode === Crafty.keys.A) {				move.left = true;			}			if(e.keyCode === Crafty.keys.UA || e.keyCode === Crafty.keys.W) {				move.up = true;			}		}).bind("keyup", function(e) {			if(e.keyCode === Crafty.keys.RA || e.keyCode === Crafty.keys.D) {				move.right = false;			}			if(e.keyCode === Crafty.keys.LA || e.keyCode === Crafty.keys.A) {				move.left = false;			}		});				return this;	}});